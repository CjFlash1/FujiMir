generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String   // Hashed
  role      String   @default("ADMIN")
  name      String?
  createdAt DateTime @default(now())
}

model Order {
  id             Int         @id @default(autoincrement())
  orderNumber    String      @unique // e.g., "ORD-1001"
  status         String      @default("PENDING") // PENDING, PROCESSING, COMPLETED, CANCELLED
  totalAmount    Float
  customerName   String
  customerPhone  String
  customerEmail  String?
  deliveryAddress String?
  deliveryMethod String      @default("PICKUP") // PICKUP, POST
  
  items          OrderItem[]
  
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
}

model OrderItem {
  id          Int      @id @default(autoincrement())
  orderId     Int
  order       Order    @relation(fields: [orderId], references: [id])
  
  type        String   // "PRINT", "SHOP_ITEM"
  name        String   // "10x15 Glossy"
  
  quantity    Int
  price       Float    // Unit price snapshot
  subtotal    Float
  
  // Specifics
  size        String?  // "10x15"
  paper       String?  // "Glossy"
  options     String?  // JSON: { "border": true, "magnetic": false }
  files       String?  // JSON: ["img1.jpg"]
  
  createdAt   DateTime @default(now())
}

// --- Dynamic Product Configuration ---

model PrintSize {
  id          Int      @id @default(autoincrement())
  name        String   // "10x15"
  slug        String   @unique // "10x15"
  widthMm     Float?
  heightMm    Float?
  basePrice   Float
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
}

model PaperType {
  id          Int      @id @default(autoincrement())
  name        String   // "Glossy", "Matte"
  slug        String   @unique // "glossy", "matte"
  description String?
  isActive    Boolean  @default(true)
}

model PrintOption {
  id          Int      @id @default(autoincrement())
  name        String   // "Border", "Magnetic"
  slug        String   @unique // "border", "magnetic"
  priceType   String   // "FIXED", "PERCENT", "PER_AREA"? -> Simplified: "FIXED" usually
  price       Float    // 0 for border, 10 for magnetic
  isActive    Boolean  @default(true)
}

// --- Generic Product (Shop) ---

model Product {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  price       Float
  images      String?  // JSON
  stock       Int      @default(0)
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
}

// --- System & Localization ---

model Translation {
  id        Int      @id @default(autoincrement())
  lang      String   // "uk", "ru", "en"
  key       String   // "hero.title"
  value     String   // "Друк фото"
  
  @@unique([lang, key])
}

model Setting {
  key         String   @id
  value       String
  description String?
}
